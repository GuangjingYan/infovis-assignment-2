{"ast":null,"code":"var _jsxFileName = \"/Users/yanguangjing/Downloads/snu-infovis-assn-2-skeleton-master/src/components/Mainplot.js\",\n    _s = $RefreshSig$();\n\nimport React, { useRef, useEffect, useState } from \"react\";\nimport * as d3 from \"d3\";\nimport { Update } from \"@material-ui/icons\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst Mainplot = props => {\n  _s();\n\n  const {\n    width,\n    height,\n    margin,\n    pointSize,\n    maxPointSize,\n    data,\n    movieData\n  } = props;\n  const {\n    xPosition,\n    yPosition,\n    color,\n    opacity,\n    size\n  } = data;\n  const svgWidth = margin * 2 + width;\n  const svgHeight = margin * 2 + height;\n  const splotSvg = useRef(null);\n  let circleSvg, yAxisSvg, xAxisSvg, yExtent, xExtent, rExtent, xAxis, yAxis;\n  const [isUpdate, setisUpdate] = useState(false);\n\n  const drawSplot = () => {\n    console.log(`draw`);\n    xExtent = d3.extent(movieData.map(d => parseFloat(d[xPosition])));\n    yExtent = d3.extent(movieData.map(d => parseFloat(d[yPosition])));\n    rExtent = d3.extent(movieData.map(d => parseFloat(d[size])));\n    const xScale = d3.scaleLinear().domain(xExtent).range([0, width]);\n    const yScale = d3.scaleLinear().domain(yExtent).range([height, 0]);\n    const rScale = d3.scaleLinear().domain(rExtent).range([pointSize, maxPointSize]);\n    xAxis = d3.axisBottom(xScale);\n    yAxis = d3.axisLeft(yScale);\n    const svg = d3.select(splotSvg.current);\n    xAxisSvg = d3.select(splotSvg.current).append(\"g\").attr(\"transform\", `translate(${margin},${height + margin})`);\n    xAxisSvg.call(xAxis);\n    yAxisSvg = d3.select(splotSvg.current).append(\"g\").attr(\"transform\", `translate(${margin}, ${margin})`);\n    yAxisSvg.call(yAxis);\n    circleSvg = svg.append(\"g\").attr(\"transform\", `translate(${margin}, ${margin})`).attr(\"class\", \".circleSvg\");\n    circleSvg.selectAll(\"circle\").data(movieData).enter().append(\"circle\").attr(\"cx\", d => xScale(parseFloat(d[xPosition]))).attr(\"cy\", d => yScale(parseFloat(d[yPosition]))).attr(\"class\", (_, i) => \"circle\" + i).attr(\"r\", pointSize).attr(\"fill\", \"red\");\n    let brush = d3.brush().extent([[0, 0], [width, height]]).on(\"start brush end\", brushed);\n    const brushSvg = svg.append(\"g\").attr(\"transform\", \"translate(\" + props.margin + \",\" + props.margin + \")\");\n    brushSvg.call(brush);\n\n    function brushed({\n      selection\n    }) {\n      if (selection === null) {\n        return;\n      }\n\n      let [[x0, y0], [x1, y1]] = selection;\n      const insideBrush = movieData.map((d, i) => {\n        const xCoor = xScale(parseFloat(d[xPosition]));\n        const yCoor = yScale(parseFloat(d[yPosition]));\n        if (xCoor >= x0 && xCoor <= x1 && yCoor >= y0 && yCoor <= y1) return true;else return false;\n      });\n      const insideBrushIdx = insideBrush.reduce((acc, cur, i) => {\n        if (cur) acc.push(i);\n        return acc;\n      }, []);\n      d3.selectAll(\"circle\").attr(\"stroke\", \"none\");\n      insideBrushIdx.forEach(idx => {\n        d3.selectAll(\".circle\" + idx).attr(\"stroke\", \"black\");\n      });\n    } //  setTimeout(() => {\n    //   setisUpdate(true);\n    // }, 3000);\n\n\n    setisUpdate(true);\n  };\n\n  const updateSplot = () => {\n    console.log(`update`);\n    console.log(data); //update \n\n    xExtent = d3.extent(movieData.map(d => parseFloat(d[xPosition])));\n    yExtent = d3.extent(movieData.map(d => parseFloat(d[yPosition])));\n    rExtent = d3.extent(movieData.map(d => parseFloat(d[size])));\n    const xScale = d3.scaleLinear().domain(xExtent).range([0, width]);\n    const yScale = d3.scaleLinear().domain(yExtent).range([height, 0]);\n    const rScale = d3.scaleLinear().domain(rExtent).range([pointSize, maxPointSize]);\n    const xAxis = d3.axisBottom(xScale);\n    xAxisSvg = d3.select(\".xAxisSvg\");\n    xAxisSvg.call(xAxis);\n    const yAxis = d3.axisLeft(yScale);\n    yAxisSvg = d3.select(\".yAxisSvg\");\n    yAxisSvg.call(yAxis);\n    circleSvg = d3.select(\".circleSvg\");\n    circleSvg.selectAll(\"circle\").data(movieData).join().transition().duration(100).attr(\"cx\", d => xScale(parseFloat(d[xPosition]))).attr(\"cy\", d => yScale(parseFloat(d[yPosition]))).attr(\"r\", d => rScale(parseFloat(d[size]))).attr(\"fill\", \"black\");\n  };\n\n  useEffect(() => {\n    if (isUpdate == false) drawSplot();else updateSplot();\n  }, [data]); // useEffect(() => {\n  //   updateSplot();\n  // }, [isUpdate]);\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: /*#__PURE__*/_jsxDEV(\"svg\", {\n      ref: splotSvg,\n      width: svgWidth,\n      height: svgHeight\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 142,\n      columnNumber: 4\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 141,\n    columnNumber: 3\n  }, this);\n};\n\n_s(Mainplot, \"20Xx/35vin57C2yVABD0dbIBXoo=\");\n\n_c = Mainplot;\nexport default Mainplot;\n\nvar _c;\n\n$RefreshReg$(_c, \"Mainplot\");","map":{"version":3,"sources":["/Users/yanguangjing/Downloads/snu-infovis-assn-2-skeleton-master/src/components/Mainplot.js"],"names":["React","useRef","useEffect","useState","d3","Update","Mainplot","props","width","height","margin","pointSize","maxPointSize","data","movieData","xPosition","yPosition","color","opacity","size","svgWidth","svgHeight","splotSvg","circleSvg","yAxisSvg","xAxisSvg","yExtent","xExtent","rExtent","xAxis","yAxis","isUpdate","setisUpdate","drawSplot","console","log","extent","map","d","parseFloat","xScale","scaleLinear","domain","range","yScale","rScale","axisBottom","axisLeft","svg","select","current","append","attr","call","selectAll","enter","_","i","brush","on","brushed","brushSvg","selection","x0","y0","x1","y1","insideBrush","xCoor","yCoor","insideBrushIdx","reduce","acc","cur","push","forEach","idx","updateSplot","join","transition","duration"],"mappings":"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","sourcesContent":["import React, { useRef, useEffect, useState} from \"react\";\nimport * as d3 from \"d3\";\nimport { Update } from \"@material-ui/icons\";\n\nconst Mainplot = (props) => {\n  const { width, height, margin, pointSize, maxPointSize, data, movieData } = props;\n  const { xPosition, yPosition, color, opacity, size} = data;\n\n  const svgWidth = margin * 2 + width;\n  const svgHeight = margin * 2 + height;\n  const splotSvg = useRef(null);\n  let circleSvg, yAxisSvg, xAxisSvg, yExtent, xExtent, rExtent, xAxis,yAxis;\n  const[isUpdate, setisUpdate] = useState(false);\n\n  const drawSplot = () =>{\n    console.log(`draw`);\n    xExtent = d3.extent(movieData.map(d => parseFloat(d[xPosition])));\n    yExtent = d3.extent(movieData.map(d => parseFloat(d[yPosition])));\n    rExtent = d3.extent(movieData.map(d => parseFloat(d[size])));\n\n    const xScale  = d3.scaleLinear().domain(xExtent).range([0, width]);\n    const yScale  = d3.scaleLinear().domain(yExtent).range([height, 0]);\n    const rScale = d3.scaleLinear().domain(rExtent).range([pointSize, maxPointSize]);\n  \n    xAxis = d3.axisBottom(xScale)\n    yAxis = d3.axisLeft(yScale)\n    const svg = d3.select(splotSvg.current);\n\n\t\txAxisSvg = d3.select(splotSvg.current)\n\t\t \t.append(\"g\")\n      .attr(\"transform\", `translate(${ margin },${ height + margin })`)\n\t\t\n    xAxisSvg.call(xAxis)\n\n\t\tyAxisSvg = d3.select(splotSvg.current)\n\t\t  .append(\"g\")\n\t\t  .attr(\"transform\", `translate(${ margin }, ${ margin })`)\n\t\t\t\n    yAxisSvg.call(yAxis)\n\n\t\tcircleSvg = svg.append(\"g\").attr(\"transform\", `translate(${ margin }, ${ margin })`).attr(\"class\", \".circleSvg\")\n\n\t\tcircleSvg.selectAll(\"circle\")\n\t\t\t\t\t\t .data(movieData)\n\t\t\t\t\t\t .enter()\n\t\t\t\t\t\t .append(\"circle\")\n\t\t\t\t\t\t .attr(\"cx\", d => xScale(parseFloat(d[xPosition])))\n\t\t\t\t\t\t .attr(\"cy\", d => yScale(parseFloat(d[yPosition])))\n\t\t\t\t\t\t .attr(\"class\", (_, i) => \"circle\" + i)\n\t\t\t\t\t\t .attr(\"r\", pointSize)\n             .attr(\"fill\", \"red\")\n\n\n    let brush = d3.brush()\n                  .extent([[0, 0], [width, height]])\n                  .on(\"start brush end\", brushed)\n\t\t\n    const brushSvg = svg.append(\"g\")\n                        .attr(\"transform\", \"translate(\" + props.margin + \",\" + props.margin + \")\")\n                        \n    brushSvg.call(brush);\n\n    function brushed({selection}) {\n\n      if (selection === null) {\n        return;\n      }\n\n      let [[x0, y0], [x1, y1]] = selection;\n\n      const insideBrush = movieData.map((d, i) => {\n        const xCoor = xScale(parseFloat(d[xPosition]));\n        const yCoor = yScale(parseFloat(d[yPosition]));\n        if (xCoor >= x0 && xCoor <= x1 &&\n            yCoor >= y0 && yCoor <= y1\n        ) return true;\n        else return false;\n      })\n\n      const insideBrushIdx = insideBrush.reduce((acc, cur, i) => {\n        if (cur) acc.push(i);\n        return acc;\n      }, []);\n      d3.selectAll(\"circle\").attr(\"stroke\", \"none\");\n      insideBrushIdx.forEach(idx => {\n        d3.selectAll(\".circle\" + idx)\n          .attr(\"stroke\", \"black\")\n      });\t\t\n     }\n    //  setTimeout(() => {\n    //   setisUpdate(true);\n    // }, 3000);\n    setisUpdate(true);\n  }\n\n  const updateSplot = () =>{\n    console.log(`update`);\n    console.log(data);\n    //update \n    xExtent = d3.extent(movieData.map(d => parseFloat(d[xPosition])));\n    yExtent = d3.extent(movieData.map(d => parseFloat(d[yPosition])));\n    rExtent = d3.extent(movieData.map(d => parseFloat(d[size])));\n\n    const xScale  = d3.scaleLinear().domain(xExtent).range([0, width]);\n    const yScale  = d3.scaleLinear().domain(yExtent).range([height, 0]);\n    const rScale = d3.scaleLinear().domain(rExtent).range([pointSize, maxPointSize]);\n\n    const xAxis = d3.axisBottom(xScale);\n    xAxisSvg = d3.select(\".xAxisSvg\")\n    xAxisSvg.call(xAxis);\n    const yAxis = d3.axisLeft(yScale);\n    yAxisSvg = d3.select(\".yAxisSvg\")\n    yAxisSvg.call(yAxis);\n\n    circleSvg = d3.select(\".circleSvg\")\n    circleSvg.selectAll(\"circle\")\n    .data(movieData)\n    .join()\n    .transition()\n    .duration(100)\n    .attr(\"cx\", d => xScale(parseFloat(d[xPosition])))\n    .attr(\"cy\", d => yScale(parseFloat(d[yPosition])))\n    .attr(\"r\", d => rScale(parseFloat(d[size])))\n    .attr(\"fill\", \"black\")\n}\n\n\n  useEffect(() => {\n    if(isUpdate == false)\n      drawSplot();\n    else\n      updateSplot();\n\t}, [data]);\n\n  // useEffect(() => {\n  //   updateSplot();\n\t// }, [isUpdate]);\n\n    \n  return (\n\t\t<div>\n\t\t\t<svg ref={splotSvg} width={svgWidth} height={svgHeight}> \n\t\t\t</svg>\n    </div>\n  )\n\n}\nexport default Mainplot;"]},"metadata":{},"sourceType":"module"}